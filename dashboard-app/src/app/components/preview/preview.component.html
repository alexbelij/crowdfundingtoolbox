<div *ngIf="campaignId" class="active bg-overlay"></div>
<div class="preview" [ngClass]="class" [style.display]="(show) ? 'block' : 'none'">
  <span (click)="closePreview()"
        class="actionIcon btn-close"
        title="Delete"
        [inlineSVG]="'assets/images/icons/preview_close.svg'"
  ></span>
    <div class="header container">
        <div class="row">
            <div class="col-3 vertical-align">
                PREVIEW MODE
            </div>
            <div class="col-2 offset-2 vertical-align">
                <ng-container *ngIf="campaignId">
                    <app-radio-button-group [radioButtons]="deviceTypeButtons" [(currentValue)]="deviceType" [class]="'small'">
                    </app-radio-button-group>
                </ng-container>
            </div>
            <div class="col-1 offset-2 flex-center">
                <label for="scale">Scale [%]</label>
            </div>
            <div class="col-2">
                <app-inputNumber id="scale"
                                 [(value)]="scale"
                                 [class]="'float-right'">
                </app-inputNumber>
            </div>
        </div>
    </div>

    <div *ngIf="campaignId" class="tabs">
        <button *ngFor="let wid of widgets" type="button" [class]="(widget == wid) ? 'active' : ''"
                (click)="changeWidget(wid)">{{wid.widget_type.name}}
        </button>
    </div>

    <app-loading [isLoading]="loading">
    </app-loading>

    <!--<iframe #pagePreview [src]="'https://postoj.ondas.me/' | safe "  width="100%" height="400px">-->

    <!--</iframe>-->

    <!-- iframe encapsulated TODO -->
    <iframe id="crowdWidgetContent-preview" [ngStyle]="{'transform': 'scale('+scale/100+')'}" [hidden]="loading" #iframe frameborder="0" width="100%" height="100%" class="{{deviceType}}"></iframe>
    <div #preview [ngModel]="changePreview(preview)" style="display:none" name="preview" ngDefaultControl>
        <link [href]="'https://fonts.googleapis.com/css?family=' + fontFamilyPreview | safe" rel="stylesheet">
        <div class="cft--background" [ngStyle]="getBackgroundStyle()" [id]="'cr0wdWidgetContent-'+widget.widget_type.method">
            <div class="cft--overlay" [ngStyle]="getOverlayStyle()"></div>
            <div class="cft--body" [ngStyle]="getBodyStyle()">
                <div class="cft--text-container"  [ngStyle]="getTextContainerStyle()">
                    <div class="cft--headline-text" [ngStyle]="getHeadlineTextStyle()" [innerHTML]="widget.settings[deviceType].headline_text">
                    </div>
                    <div class="cft--additional-text" [ngStyle]="getAdditionalTextStyle()" [innerHTML]="widget.settings[deviceType].widget_settings.additional_text?.text">
                    </div>
                </div>
                <div class="cft--monetization--container" [ngStyle]="getMonetizationContainerStyle()" *ngIf="widget.settings[deviceType].payment_settings.active">
                    <div class="cft--monatization--title">
                    </div>
                    <div id="cft--monatization--donation-button-wrapper" class="cft--monatization--donation-button-wrapper" [ngStyle]="getRowStyle()">
                        <div class="cft--monatization--donation-button-container"
                             [ngClass]="{'active': widget.settings[deviceType].payment_settings.default_price.value == option.value}"
                             [ngStyle]="getMonatizationDonationButtonStyle()"
                             onclick="parent.setActiveButton(this)"
                             *ngFor="let option of widget.settings[deviceType].payment_settings.monthly_prices.options">
                            <div class="cft--monatization--donation-button" [ngStyle]="getDonationButtonStyle()">
                                <input type="hidden" value="{{option.value}}">
                                <div class="cft--monatization--donation-button-price" [ngStyle]="getDonationButtonPriceStyle()"> {{option.value}}</div>
                                <div class="cft--monatization--donation-button-periodicity" [ngStyle]="getDonationButtonPeriodicityStyle()"> monthly </div>
                            </div>
                        </div>
                        <div class="cft--monatization--donation-button-container"
                             onclick="parent.setActiveButton(this)"
                             oninput="parent.setActiveButton(this)"
                             [ngClass]="{'active': widget.settings[deviceType].payment_settings.default_price.value == 'custom' }"
                             [ngStyle]="getMonatizationDonationButtonStyle()"
                             *ngIf="widget.settings[deviceType].payment_settings.monthly_prices.custom_price">
                            <div class="cft--monatization--donation-button" [ngStyle]="getDonationButtonStyle()">
                                <input type="number" class="cft--monatization--donation-input-price" [ngStyle]="getDonationInputPriceStyle()" placeholder="custom"/>
                                <div class="cft--monatization--donation-button-periodicity" [ngStyle]="getDonationButtonPeriodicityStyle()"> monthly </div>
                            </div>
                        </div>
                    </div>
                    <div class="cft--monatization--membership">
                        <span class="cft--monatization--membership-checkbox" id="cft--monatization--membership-checkbox"></span>
                        <div class="cft--monatization--membership-membership-text" [ngStyle]="getMembershipStyle()">S podporou 10&nbsp;€ a&nbsp;viac mesačne sa môžete <strong>stať členom Klubu Postoj a&nbsp;získať naše špeciálne tlačené vydanie.</strong></div>
                    </div>
                    <form id="cft--monatization--form--donate" onsubmit="return parent.validateForm(this)" class="form" action="#" method="post" novalidate>
                        <div class="cft--monatization--form-group--donate" [ngStyle]="getFormGroupStyle()">
                            <label for="cft--monatization--form--donate--email" class="label" [ngStyle]="getLabelStyle()">Váš e-mail</label>
                            <input class="cft--monatization--form--donate--email" type="email"
                                   id="cft--monatization--form--donate--email" [ngStyle]="getEmailDonateStyle()"
                                   name="email" required>
                            <label id="cft--monatization--form-email-error" class="error" [ngStyle]="getErrorStyle()" for="cft--monatization--form--donate--email">Nesprávny e-mail</label>
                        </div>
                        <div class="cft--monatization--form--donate--terms" [ngStyle]="getFormGroupStyle()">
                            <input id="cft--monatization--form--donate--terms" type="checkbox" name="terms_agreed" value="0"  required>
                            <label for="cft--monatization--form--donate--terms">Súhlasím so spracovaním <a href="https://podpora.postoj.sk/assets/donations-widget/pdf/suhlas_so_spracovanim_osobnych_udajov.pdf">osobných údajov</a> a zasielaním noviniek</label>
                            <label id="cft--monatization--form--donate--terms-error"
                                   [ngStyle]="getErrorStyle()"
                                   class="error"
                                   for="cft--monatization--form--donate--terms">Please agree with terms and conditions</label>
                        </div>
                        <div class="cft--button-container" [ngStyle]="getButtonContainerStyles()" *ngIf="ctaReplaced()">
                            <button type="submit" class="cft--button"
                               [ngStyle]="getButtonStyles()">
                                {{widget.settings[deviceType].cta.text}}
                            </button>
                        </div>
                    </form>
                    <div class="additional-links">
                        <a href="#" onclick="parent.oneTimePayment()">Jednorazový príspevok</a>
                    </div>
                </div>
                <!-- CTA -->
                <div class="cft--button-container" [ngStyle]="getButtonContainerStyles()" *ngIf="!ctaReplaced()">
                    <a class="cft--button"
                       [ngStyle]="getButtonStyles()"
                       href="{{widget.settings[deviceType].cta.url}}">
                        {{widget.settings[deviceType].cta.text}}
                    </a>
                </div>
            </div>
        </div>
        <div id="styles">
        </div>
            <div id="scripts">
            </div>
    </div>
</div>
